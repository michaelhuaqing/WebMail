<html>
  <head>
    <title>添加表格信息</title>
<script language="javascript" type="text/javascript">
function AddRow()
{
 //添加一行
 var i =tab1.rows.length;
 var sign="add"+i;
 var keyword_a="-a-"+i;
 var keyword_b="-b-"+i;
 var content_a="subject-a-"+i;
 var content_b="subject-b-"+i;
 var newTr = tab1.insertRow();
 //添加列
 var newTd0 = newTr.insertCell();
 var newTd1 = newTr.insertCell();
 var newTd2 = newTr.insertCell();
 var newTd3 = newTr.insertCell();
 var newTd4 = newTr.insertCell();
 var newTd5 = newTr.insertCell();
 var newTd6 = newTr.insertCell();
 //设置列内容和属性
 newTd0.innerHTML = '<input type="checkbox" id="box1" onClick="GetRow()"/ /><input type="hidden" name="add" id='+sign+' />';
 newTd1.innerHTML = '<td> <select name="relation"><option value="and">并含</option><option value="or">或含</option>'+
     '<option value="not">不含</option></td></select>';
 newTd2.innerHTML = '<td> <select name="keyword" id='+keyword_a+' onChange="ChangeA(this.options[this.selectedIndex].value+this.id)">'+
     '<option value="subject">主题</option><option value="sender">发件人</option>'+
	 '<option value="receiver">收件人</option><option value="ipaddress">ip地址</option><option value="boby_txt">内容</option>'+
     '<option value="attach_txt">附件</option><option value="start">开始时间</option><option value="to">结束时间</option></select></td>';
	 
 newTd3.innerHTML = '<td> <input type="text" name="content" id='+content_a+'></td>';
 
 newTd4.innerHTML ='<td> <select name="relation"><option value="and">并且</option><option value="or">或者</option>'+
     '<option value="not">不含</option></td></select>';
 newTd5.innerHTML ='<td> <select name="keyword" id='+keyword_b+' onChange="ChangeB(this.options[this.selectedIndex].value+this.id)">'+
     '<option value="subject">主题</option><option value="sender">发件人</option>'+
	 '<option value="receiver">收件人</option><option value="ipaddress">ip地址</option><option value="boby_txt">内容</option>'+
     '<option value="attach_txt">附件</option><option value="start">开始时间</option><option value="to">结束时间</option></select></td>';
	 
 newTd6.innerHTML ='<td> <input type="text" name="content" id='+content_b+'></td>';
}
function ChangeA(a)
{
	content_a=a;
	alert(a);
}
function ChangeB(b)
{
	content_b=b;
	alert(b);
}
function DelRow()
{
//删除一行
  var selected_boxnum=0;
  var box_obj=document.all("box1");
   for(var i=0;i<box_obj.length;i++)
   {
    if (box_obj[i].checked==true)
    {
      selected_boxnum++;
    }
   }
   if(selected_boxnum==box_obj.length)
   {
     alert('最少要添加一项');
     return;
   }
   else  if(selected_boxnum==0)
   {
     alert('请选择你要删除的信息');
     return;
   }
   else if(selected_boxnum==1)
   {
     for(var i=0;i<box_obj.length;i++)
     {
       if(box_obj[i].checked==true)
       {
        tab1.deleteRow(i+1);
       }
     }
   }
   else if(selected_boxnum>1)
   {
     for(var a=0;a<selected_boxnum;a++)
     {
         for(var i=0;i<box_obj.length;i++)
      {
        if(box_obj[i].checked==true)
        {
         tab1.deleteRow(i+1);
         break;
        }
      }
     }
   }
}
function GetRow()
{
  //获得行索引
  //两个parentElement分别是TD和TR哟，rowIndex是TR的属性
  //this.parentElement.parentElement.rowIndex
  cGetRow=window.event.srcElement.parentElement.parentElement.rowIndex;
}

</script>
  </head>
  <body>
 <form name="form1" method="get">
 <center>   
  <table id="tab1" align="center" border="1" cellPadding="4" cellSpacing="0" borderColorLight="#999999" borderColorDark="#ffffff" style="width:65%;word-break: break-all">
      <thead>
    <tr>
     <th align="center" width="10%">选择</th>
     <th align="center" width="15%">逻辑</th>
     <th align="center" width="15%">查询关键词</th>
     <th align="center" width="15%">查询内容</th>
     <th align="center" width="15%">关系</th>
     <th align="center" width="15%">查询关键词</th>
     <th align="center" width="15%">查询内容</th>
    </tr>
   </thead>
               <tr >
     <td><input type=checkbox id="box1" onClick="GetRow()" />
         <input type="hidden" name="add" id="add1" />
     </td> 
     <td>
     <input type="hidden"/>
     </td>
     <td> 
     <select name="keyword" id="keyword-a-1" onChange="ChangeA(this.options[this.selectedIndex].value)">
	 <option value="subject">主题</option>
	 <option value="from_">发件人</option>
	 <option value="to">收件人</option>
	 <option value="ip">ip地址</option>
     <option value="boby_txt">内容</option>
     <option value="attach_txt">附件</option>
     <option value="start">开始时间</option>
     <option value="to">结束时间</option>
	 </select>
     </td>
     <td> <input type="text" name="content"></td>
     <td> <select name="relation">
     <option value="and">并含</option>
     <option value="or">或含</option>
     <option value="not">不含</option>
     </td>
     </select>
     <td> 
     <select name="keyword" id="keyword-b-1" onChange="ChangeB(this.options[this.selectedIndex].value)">
	 <option value="subject">主题</option>
	 <option value="from_">发件人</option>
	 <option value="to">收件人</option>
	 <option value="ip">ip地址</option>
     <option value="boby_txt">内容</option>
     <option value="attach_txt">附件</option>
     <option value="start">开始时间</option>
     <option value="to">结束时间</option>
	 </select>
     </td>
     
     <td> <input type="text" name="content"></td>
            </tr>
  
       </table>
       <table  align="center" border="1" cellPadding="4" cellSpacing="0" borderColorLight="#999999" borderColorDark="#ffffff" style="width:65%;word-break: break-all">
       <tr>
         <td align="right">
       <input type="button" name="Submit" value="增加一行" onClick="javascript:AddRow();" />
          <input type="button" name="Submit" value="删除一行" onClick="javascript:DelRow();" />
         </td>
      </tr>
   </table>
</form>
  </body>
 
</html>
